<?xml version="1.0" encoding="UTF-8"?>
<xmi:XMI xmi:version="2.1" xmlns:uml="http://schema.omg.org/spec/UML/2.1" xmlns:xmi="http://schema.omg.org/spec/XMI/2.1">
  <xmi:Documentation exporter="Manual" exporterVersion="1.0"/>

  <uml:Model xmi:type="uml:Model" xmi:id="model1" name="Transfer Flow Model">

    <!-- Activity Diagram -->
    <packagedElement xmi:type="uml:Activity" xmi:id="activity1" name="Transfer Engine Flow">

      <!-- Initial Node -->
      <node xmi:type="uml:InitialNode" xmi:id="initial1" name="Start"/>

      <!-- Prepare Paths -->
      <node xmi:type="uml:Action" xmi:id="action1" name="preparePaths()">
        <body>Create flow paths and set raw path</body>
      </node>

      <!-- Pre Transfer Decision -->
      <node xmi:type="uml:DecisionNode" xmi:id="decision1" name="PreTransfer?"/>

      <!-- Pre Engine -->
      <node xmi:type="uml:Action" xmi:id="action2" name="preEngine()">
        <body>Execute pre-transfer operations</body>
      </node>

      <!-- On Transfer Decision -->
      <node xmi:type="uml:DecisionNode" xmi:id="decision2" name="OnTransfer?"/>

      <!-- On Engine -->
      <node xmi:type="uml:Action" xmi:id="action3" name="onEngine()">
        <body>Execute transfer operations with thread pool</body>
      </node>

      <!-- Get Connections -->
      <node xmi:type="uml:Action" xmi:id="action4" name="getConnections()">
        <body>Fetch active connections from repository</body>
      </node>

      <!-- For Each Connection -->
      <node xmi:type="uml:Action" xmi:id="action5" name="For Each Connection">
        <body>Process each connection in parallel</body>
      </node>

      <!-- Transfer Handler Start -->
      <node xmi:type="uml:CallBehaviorAction" xmi:id="action6" name="TransferBaseHandler.run()"/>

      <!-- Handler: Start Connection -->
      <node xmi:type="uml:Action" xmi:id="handler1" name="startConnection()">
        <body>Establish connection to remote server</body>
      </node>

      <!-- Handler: Pre Handler -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision1" name="PreThread?"/>
      <node xmi:type="uml:Action" xmi:id="handler2" name="preHandler()">
        <body>Pre-handler operations</body>
      </node>

      <!-- Handler: Check Last Modified Time -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision2" name="CheckLastModifiedTime?"/>
      <node xmi:type="uml:Action" xmi:id="handler3" name="checkLastModifiedTime()">
        <body>Verify and update last modified time</body>
      </node>

      <!-- Handler: Read Files -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision3" name="ReadFiles?"/>
      <node xmi:type="uml:Action" xmi:id="handler4" name="readFiles()">
        <body>Read files from remote path</body>
      </node>

      <!-- Handler: Filter Files -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision4" name="FilterFiles?"/>
      <node xmi:type="uml:Action" xmi:id="handler5" name="filterFiles()">
        <body>Filter files by modified time</body>
      </node>

      <!-- Handler: Set File Info -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision5" name="SetFileInfo?"/>
      <node xmi:type="uml:Action" xmi:id="handler6" name="setFileInfo()">
        <body>Set additional file information</body>
      </node>

      <!-- Handler: Cache Results -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision6" name="CacheResults?"/>
      <node xmi:type="uml:Action" xmi:id="handler7" name="cacheResults()">
        <body>Save results to database</body>
      </node>

      <!-- Handler: Set Last Modified Time -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision7" name="SetLastModifiedTime?"/>
      <node xmi:type="uml:Action" xmi:id="handler8" name="setLastModifiedTime()">
        <body>Update last modified time in DB</body>
      </node>

      <!-- Handler: Clear Remote Files -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision8" name="ClearRemoteFiles?"/>
      <node xmi:type="uml:Action" xmi:id="handler9" name="clearRemoteFiles()">
        <body>Clear remote files list</body>
      </node>

      <!-- Handler: Download -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision9" name="Download?"/>
      <node xmi:type="uml:Action" xmi:id="handler10" name="download()">
        <body>Download files from remote server</body>
      </node>

      <!-- Handler: Post Handler -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision10" name="PostThread?"/>
      <node xmi:type="uml:Action" xmi:id="handler11" name="postHandler()">
        <body>Post-handler operations</body>
      </node>

      <!-- Handler: Close Connection -->
      <node xmi:type="uml:Action" xmi:id="handler12" name="closeConnection()">
        <body>Disconnect from remote server</body>
      </node>

      <!-- Decompress Decision -->
      <node xmi:type="uml:DecisionNode" xmi:id="decision3" name="Decompress?"/>

      <!-- Decompress -->
      <node xmi:type="uml:Action" xmi:id="action7" name="decompress()">
        <body>Decompress files with thread pool</body>
      </node>

      <!-- Validation Decision -->
      <node xmi:type="uml:DecisionNode" xmi:id="decision4" name="Validation?"/>

      <!-- Validation -->
      <node xmi:type="uml:Action" xmi:id="action8" name="validation()">
        <body>Validate XML files with thread pool</body>
      </node>

      <!-- Post Transfer Decision -->
      <node xmi:type="uml:DecisionNode" xmi:id="decision5" name="PostTransfer?"/>

      <!-- Post Engine -->
      <node xmi:type="uml:Action" xmi:id="action9" name="postEngine()">
        <body>Execute post-transfer operations</body>
      </node>

      <!-- Merge Nodes -->
      <node xmi:type="uml:MergeNode" xmi:id="merge1" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="merge2" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="merge3" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="merge4" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="merge5" name=""/>

      <!-- Handler Merge Nodes -->
      <node xmi:type="uml:MergeNode" xmi:id="hmerge1" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="hmerge2" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="hmerge3" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="hmerge4" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="hmerge5" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="hmerge6" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="hmerge7" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="hmerge8" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="hmerge9" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="hmerge10" name=""/>

      <!-- Connection Success Decision -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision0" name="Connection Success?"/>

      <!-- Final Node -->
      <node xmi:type="uml:ActivityFinalNode" xmi:id="final1" name="End"/>

      <!-- Control Flows -->
      <edge xmi:type="uml:ControlFlow" xmi:id="flow1" source="initial1" target="action1"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow2" source="action1" target="decision1"/>

      <!-- Pre Transfer Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="flow3" source="decision1" target="action2" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow4" source="decision1" target="merge1" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow5" source="action2" target="merge1"/>

      <!-- On Transfer Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="flow6" source="merge1" target="decision2"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow7" source="decision2" target="action3" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow8" source="decision2" target="merge2" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow9" source="action3" target="action4"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow10" source="action4" target="action5"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow11" source="action5" target="action6"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow12" source="action6" target="merge2"/>

      <!-- Decompress Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="flow13" source="merge2" target="decision3"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow14" source="decision3" target="action7" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow15" source="decision3" target="merge3" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow16" source="action7" target="merge3"/>

      <!-- Validation Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="flow17" source="merge3" target="decision4"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow18" source="decision4" target="action8" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow19" source="decision4" target="merge4" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow20" source="action8" target="merge4"/>

      <!-- Post Transfer Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="flow21" source="merge4" target="decision5"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow22" source="decision5" target="action9" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow23" source="decision5" target="merge5" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow24" source="action9" target="merge5"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow25" source="merge5" target="final1"/>

      <!-- Handler Internal Flows -->
      <!-- Start Handler -->
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow1" source="action6" target="handler1"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow2" source="handler1" target="hdecision0"/>

      <!-- Connection Success Branch -->
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow3" source="hdecision0" target="hdecision1" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow4" source="hdecision0" target="handler12" name="NO"/>

      <!-- PreThread Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow5" source="hdecision1" target="handler2" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow6" source="hdecision1" target="hmerge1" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow7" source="handler2" target="hmerge1"/>

      <!-- CheckLastModifiedTime Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow8" source="hmerge1" target="hdecision2"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow9" source="hdecision2" target="handler3" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow10" source="hdecision2" target="hmerge2" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow11" source="handler3" target="hmerge2"/>

      <!-- ReadFiles Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow12" source="hmerge2" target="hdecision3"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow13" source="hdecision3" target="handler4" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow14" source="hdecision3" target="hmerge3" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow15" source="handler4" target="hmerge3"/>

      <!-- FilterFiles Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow16" source="hmerge3" target="hdecision4"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow17" source="hdecision4" target="handler5" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow18" source="hdecision4" target="hmerge4" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow19" source="handler5" target="hmerge4"/>

      <!-- SetFileInfo Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow20" source="hmerge4" target="hdecision5"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow21" source="hdecision5" target="handler6" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow22" source="hdecision5" target="hmerge5" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow23" source="handler6" target="hmerge5"/>

      <!-- CacheResults Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow24" source="hmerge5" target="hdecision6"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow25" source="hdecision6" target="handler7" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow26" source="hdecision6" target="hmerge6" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow27" source="handler7" target="hmerge6"/>

      <!-- SetLastModifiedTime Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow28" source="hmerge6" target="hdecision7"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow29" source="hdecision7" target="handler8" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow30" source="hdecision7" target="hmerge7" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow31" source="handler8" target="hmerge7"/>

      <!-- ClearRemoteFiles Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow32" source="hmerge7" target="hdecision8"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow33" source="hdecision8" target="handler9" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow34" source="hdecision8" target="hmerge8" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow35" source="handler9" target="hmerge8"/>

      <!-- Download Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow36" source="hmerge8" target="hdecision9"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow37" source="hdecision9" target="handler10" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow38" source="hdecision9" target="hmerge9" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow39" source="handler10" target="hmerge9"/>

      <!-- PostThread Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow40" source="hmerge9" target="hdecision10"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow41" source="hdecision10" target="handler11" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow42" source="hdecision10" target="hmerge10" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow43" source="handler11" target="hmerge10"/>

      <!-- Close Connection Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="hflow44" source="hmerge10" target="handler12"/>

    </packagedElement>

  </uml:Model>
</xmi:XMI>
