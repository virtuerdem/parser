<?xml version="1.0" encoding="UTF-8"?>
<xmi:XMI xmi:version="2.1" xmlns:uml="http://schema.omg.org/spec/UML/2.1" xmlns:xmi="http://schema.omg.org/spec/XMI/2.1">
  <xmi:Documentation exporter="Manual" exporterVersion="1.0"/>

  <uml:Model xmi:type="uml:Model" xmi:id="model1" name="Transfer Flow Model">

    <!-- Activity Diagram -->
    <packagedElement xmi:type="uml:Activity" xmi:id="activity1" name="Transfer Engine Flow">

      <!-- Initial Node -->
      <node xmi:type="uml:InitialNode" xmi:id="initial1" name="Start"/>

      <!-- Prepare Paths -->
      <node xmi:type="uml:Action" xmi:id="action1" name="preparePaths()">
        <body>Create flow paths and set raw path</body>
      </node>

      <!-- Pre Transfer Decision -->
      <node xmi:type="uml:DecisionNode" xmi:id="decision1" name="PreTransfer?"/>

      <!-- Pre Engine -->
      <node xmi:type="uml:Action" xmi:id="action2" name="preEngine()">
        <body>Execute pre-transfer operations</body>
      </node>

      <!-- On Transfer Decision -->
      <node xmi:type="uml:DecisionNode" xmi:id="decision2" name="OnTransfer?"/>

      <!-- On Engine -->
      <node xmi:type="uml:Action" xmi:id="action3" name="onEngine()">
        <body>Execute transfer operations with thread pool</body>
      </node>

      <!-- Get Connections -->
      <node xmi:type="uml:Action" xmi:id="action4" name="getConnections()">
        <body>Fetch active connections from repository</body>
      </node>

      <!-- For Each Connection -->
      <node xmi:type="uml:Action" xmi:id="action5" name="For Each Connection">
        <body>Process each connection in parallel</body>
      </node>

      <!-- Transfer Handler Start -->
      <node xmi:type="uml:CallBehaviorAction" xmi:id="action6" name="TransferBaseHandler.run()"/>

      <!-- Handler: Start Connection -->
      <node xmi:type="uml:Action" xmi:id="handler1" name="startConnection()">
        <body>Establish connection to remote server</body>
      </node>

      <!-- Handler: Pre Handler -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision1" name="PreThread?"/>
      <node xmi:type="uml:Action" xmi:id="handler2" name="preHandler()">
        <body>Pre-handler operations</body>
      </node>

      <!-- Handler: Check Last Modified Time -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision2" name="CheckLastModifiedTime?"/>
      <node xmi:type="uml:Action" xmi:id="handler3" name="checkLastModifiedTime()">
        <body>Verify and update last modified time</body>
      </node>

      <!-- Handler: Read Files -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision3" name="ReadFiles?"/>
      <node xmi:type="uml:Action" xmi:id="handler4" name="readFiles()">
        <body>Read files from remote path</body>
      </node>

      <!-- Handler: Filter Files -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision4" name="FilterFiles?"/>
      <node xmi:type="uml:Action" xmi:id="handler5" name="filterFiles()">
        <body>Filter files by modified time</body>
      </node>

      <!-- Handler: Set File Info -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision5" name="SetFileInfo?"/>
      <node xmi:type="uml:Action" xmi:id="handler6" name="setFileInfo()">
        <body>Set additional file information</body>
      </node>

      <!-- Handler: Cache Results -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision6" name="CacheResults?"/>
      <node xmi:type="uml:Action" xmi:id="handler7" name="cacheResults()">
        <body>Save results to database</body>
      </node>

      <!-- Handler: Set Last Modified Time -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision7" name="SetLastModifiedTime?"/>
      <node xmi:type="uml:Action" xmi:id="handler8" name="setLastModifiedTime()">
        <body>Update last modified time in DB</body>
      </node>

      <!-- Handler: Clear Remote Files -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision8" name="ClearRemoteFiles?"/>
      <node xmi:type="uml:Action" xmi:id="handler9" name="clearRemoteFiles()">
        <body>Clear remote files list</body>
      </node>

      <!-- Handler: Download -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision9" name="Download?"/>
      <node xmi:type="uml:Action" xmi:id="handler10" name="download()">
        <body>Download files from remote server</body>
      </node>

      <!-- Handler: Post Handler -->
      <node xmi:type="uml:DecisionNode" xmi:id="hdecision10" name="PostThread?"/>
      <node xmi:type="uml:Action" xmi:id="handler11" name="postHandler()">
        <body>Post-handler operations</body>
      </node>

      <!-- Handler: Close Connection -->
      <node xmi:type="uml:Action" xmi:id="handler12" name="closeConnection()">
        <body>Disconnect from remote server</body>
      </node>

      <!-- Decompress Decision -->
      <node xmi:type="uml:DecisionNode" xmi:id="decision3" name="Decompress?"/>

      <!-- Decompress -->
      <node xmi:type="uml:Action" xmi:id="action7" name="decompress()">
        <body>Decompress files with thread pool</body>
      </node>

      <!-- Validation Decision -->
      <node xmi:type="uml:DecisionNode" xmi:id="decision4" name="Validation?"/>

      <!-- Validation -->
      <node xmi:type="uml:Action" xmi:id="action8" name="validation()">
        <body>Validate XML files with thread pool</body>
      </node>

      <!-- Post Transfer Decision -->
      <node xmi:type="uml:DecisionNode" xmi:id="decision5" name="PostTransfer?"/>

      <!-- Post Engine -->
      <node xmi:type="uml:Action" xmi:id="action9" name="postEngine()">
        <body>Execute post-transfer operations</body>
      </node>

      <!-- Merge Node -->
      <node xmi:type="uml:MergeNode" xmi:id="merge1" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="merge2" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="merge3" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="merge4" name=""/>
      <node xmi:type="uml:MergeNode" xmi:id="merge5" name=""/>

      <!-- Final Node -->
      <node xmi:type="uml:ActivityFinalNode" xmi:id="final1" name="End"/>

      <!-- Control Flows -->
      <edge xmi:type="uml:ControlFlow" xmi:id="flow1" source="initial1" target="action1"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow2" source="action1" target="decision1"/>

      <!-- Pre Transfer Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="flow3" source="decision1" target="action2" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow4" source="decision1" target="merge1" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow5" source="action2" target="merge1"/>

      <!-- On Transfer Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="flow6" source="merge1" target="decision2"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow7" source="decision2" target="action3" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow8" source="decision2" target="merge2" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow9" source="action3" target="action4"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow10" source="action4" target="action5"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow11" source="action5" target="action6"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow12" source="action6" target="merge2"/>

      <!-- Decompress Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="flow13" source="merge2" target="decision3"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow14" source="decision3" target="action7" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow15" source="decision3" target="merge3" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow16" source="action7" target="merge3"/>

      <!-- Validation Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="flow17" source="merge3" target="decision4"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow18" source="decision4" target="action8" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow19" source="decision4" target="merge4" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow20" source="action8" target="merge4"/>

      <!-- Post Transfer Flow -->
      <edge xmi:type="uml:ControlFlow" xmi:id="flow21" source="merge4" target="decision5"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow22" source="decision5" target="action9" name="YES"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow23" source="decision5" target="merge5" name="NO"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow24" source="action9" target="merge5"/>
      <edge xmi:type="uml:ControlFlow" xmi:id="flow25" source="merge5" target="final1"/>

    </packagedElement>

  </uml:Model>
</xmi:XMI>
